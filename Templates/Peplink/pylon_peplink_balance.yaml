zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: bf8846d58f414cd488b718c930236658
      name: 'Templates/Pylon Templates'
  templates:
    - uuid: 102a735e8fa142b49703520ea89022ba
      template: 'Pylon Peplink Balance Template'
      name: 'Pylon Peplink Balance Template'
      description: 'Built for Peplink Balance based on SNMP mibs for 8.1.x or newer firmware'
      templates:
        - name: 'ICMP Ping'
      groups:
        - name: 'Templates/Pylon Templates'
      items:
        - uuid: d4f349706674459a9579b5ea6a5c42ac
          name: 'CPU Usage %'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.3.1.0
          key: cpuUsage
          delay: 30s
          history: 2w
          units: '%'
          description: 'CPU usage in percentage'
          tags:
            - tag: component
              value: CPU
          triggers:
            - uuid: 6cc7110f85e4472893732a54d2454d08
              expression: 'avg(/Pylon Peplink Balance Template/cpuUsage,{$CPU.AVG.TIME})>={$CPU.CRIT}'
              name: 'CPU Usage Critical'
              opdata: 'Percentage: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'CPU usage is above critical threshold'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: CPU
            - uuid: 5d1f6873dad449429dc49f60320bb352
              expression: 'avg(/Pylon Peplink Balance Template/cpuUsage,{$CPU.AVG.TIME})>={$CPU.WARN}'
              name: 'CPU Usage Warning'
              opdata: 'Percentage: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'CPU usage is above warning threshold'
              dependencies:
                - name: 'CPU Usage Critical'
                  expression: 'avg(/Pylon Peplink Balance Template/cpuUsage,{$CPU.AVG.TIME})>={$CPU.CRIT}'
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: CPU
        - uuid: bb94754a49564cc3a34e9387249f9c81
          name: 'Total Physical Memory'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.3.2.0
          key: hrStorageSize
          delay: 1d
          history: 1w
          trends: '0'
          units: B
          description: 'Available system memory in kilobytes'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 200d581bcd604e4687ad23f287725197
          name: 'Used Physical Memory'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.3.3.0
          key: hrStorageUsed
          history: 2w
          units: B
          description: 'Consumed system memory in kilobytes'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 62a64e462752485da1382df159598b6a
          name: 'Memory Usage %'
          type: CALCULATED
          key: memoryUsagePercent
          delay: 30s
          history: 2w
          units: '%'
          params: '(last(//hrStorageUsed)/last(//hrStorageSize))*100'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: b3dd8b4cea4946d38223acbcc266e591
              expression: 'last(/Pylon Peplink Balance Template/memoryUsagePercent)>={$MEM.CRIT}'
              name: 'Memory Usage Critical'
              opdata: 'Percentage: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Memory usage is above critical threshold'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: memory
            - uuid: aafa1831b216403baae1d1442df5ce2c
              expression: 'last(/Pylon Peplink Balance Template/memoryUsagePercent)>={$MEM.WARN}'
              name: 'Memory Usage Warning'
              opdata: 'Percentage: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Memory usage is above warning threshold'
              dependencies:
                - name: 'Memory Usage Critical'
                  expression: 'last(/Pylon Peplink Balance Template/memoryUsagePercent)>={$MEM.CRIT}'
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: memory
        - uuid: d18b5d59e1f94fd89ed564523aae672c
          name: 'Peplink Firmware'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.1.3.0
          key: peplinkFirmware
          delay: 1d
          history: 1w
          value_type: TEXT
          trends: '0'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 5ecc6708658544aa856c6751492cd6f6
              expression: 'last(/Pylon Peplink Balance Template/peplinkFirmware,#1)<>last(/Pylon Peplink Balance Template/peplinkFirmware,#2) and length(last(/Pylon Peplink Balance Template/peplinkFirmware))>0'
              name: 'Peplink Firmware has changed'
              event_name: 'Firmware has changed (new firmware: {ITEM.VALUE})'
              priority: INFO
              description: 'System firmware has changed. Ack to close.'
              manual_close: 'YES'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: b67f0b752b77427ca7d7feaa96cc9894
          name: 'Peplink Model'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.1.1.0
          key: peplinkModel
          delay: 1d
          history: 1w
          value_type: TEXT
          trends: '0'
          tags:
            - tag: component
              value: system
        - uuid: 3fa4bb1c103a463e9fd65ebcc3aa7a21
          name: 'Peplink Serial'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.23695.200.1.1.1.1.2.0
          key: peplinkSerial
          delay: 1d
          history: 1w
          value_type: TEXT
          trends: '0'
          tags:
            - tag: component
              value: system
        - uuid: 5a1dae3b100e495db49f70ee9f554e33
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 1d
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: b3656de983ed472797f318ead8127551
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 1d
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 694e6f46db8642bf890e6f35d18decc6
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.1.1.0
          key: 'system.hw.uptime[hrSystemUptime.0]'
          history: 2w
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 2f3b636085274a128efc786f6880b6d3
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 1d
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 02f34879c21d4237b86ea5d4c08c7af9
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1d
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 3318ca5d27784a60a089247135983b92
              expression: 'last(/Pylon Peplink Balance Template/system.name,#1)<>last(/Pylon Peplink Balance Template/system.name,#2) and length(last(/Pylon Peplink Balance Template/system.name))>0'
              name: 'System name has changed'
              event_name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: ac6eec32d4cd42efaeec2b4798f09a20
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          history: 2w
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: e41c937007f7442ea94391b36ad9a6b4
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 2w
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible value:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: cee9486376584a949ec4474b7a659a2f
              expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Pylon Peplink Balance Template/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: bef377fe9c924a8e92a90fe01fdd7c48
          name: 'Cellular Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CELLID},.1.3.6.1.4.1.23695.200.1.12.1.1.1.1,{#WANID},.1.3.6.1.4.1.23695.200.1.12.1.1.1.2]'
          key: cellular.discovery
          delay: 1h
          lifetime: 2d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discover Cellular Modems'
          item_prototypes:
            - uuid: 2624bad507fc4fd9b13f5a7d032d6815
              name: 'Cellular Modem {#CELLID} Band'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.10.{#CELLID}'
              key: 'cellular.band[{#CELLID}]'
              history: 2w
              value_type: TEXT
              trends: '0'
              tags:
                - tag: component
                  value: cellular
            - uuid: e155c0397cf94b0986402765238043ca
              name: 'Cellular Modem {#CELLID} Data Mode'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.9.{#CELLID}'
              key: 'cellular.mode[{#CELLID}]'
              history: 2w
              value_type: TEXT
              trends: '0'
              tags:
                - tag: component
                  value: cellular
            - uuid: 25d3fe07ca8941f4881dc83c65fb62a4
              name: 'Cellular Modem {#CELLID} RSRP'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.7.{#CELLID}'
              key: 'cellular.rsrp[{#CELLID}]'
              history: 2w
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return parseInt(value);'
              tags:
                - tag: component
                  value: cellular
            - uuid: 2b4bc74843074bd3a0f41afebfce1b2d
              name: 'Cellular Modem {#CELLID} RSRQ'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.8.{#CELLID}'
              key: 'cellular.rsrq[{#CELLID}]'
              history: 2w
              value_type: FLOAT
              units: db
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return parseInt(value);'
              tags:
                - tag: component
                  value: cellular
            - uuid: 21e707b852b74cb3be3df4a61f52baf9
              name: 'Cellular Modem {#CELLID} RSSI'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.3.{#CELLID}'
              key: 'cellular.rssi[{#CELLID}]'
              history: 2w
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return parseInt(value);'
              tags:
                - tag: component
                  value: cellular
            - uuid: 3d765d1d49574a6e89585fc6bcb9eaf0
              name: 'Cellular Modem {#CELLID} SINR'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.12.1.1.1.5.{#CELLID}'
              key: 'cellular.sinr[{#CELLID}]'
              history: 2w
              units: db
              tags:
                - tag: component
                  value: cellular
        - uuid: 335de004326840c0abc9def92a4665ce
          name: 'Interface Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFNAME},1.3.6.1.2.1.2.2.1.2,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFTYPE}'
                value: '{$PL.IFTYPE.FILTER}'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          lifetime: 2d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: cdcb2be7254e4b14b1f3a8c148bc44b1
              name: 'Interface {#IFDESCR}: Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 5m
              history: 2w
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
            - uuid: ce7de3e65c254eb9920fef504729e492
              name: 'Interface {#IFDESCR}: Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 5m
              history: 2w
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
            - uuid: 5108282d7d6643c3b02b0b6014b8d469
              name: 'Interface {#IFDESCR}: Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: 30s
              history: 2w
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface,including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and atother times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
            - uuid: 9a286ab0735f4111879cafb80b0ecc1e
              name: 'Interface {#IFDESCR}: Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 5m
              history: 2w
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
            - uuid: 31eea9601c8549fc829aa921450044e5
              name: 'Interface {#IFDESCR}: Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 5m
              history: 2w
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
            - uuid: 39872bcb64d54a50ae28ac0b97900429
              name: 'Interface {#IFDESCR}: Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: 30s
              history: 2w
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
            - uuid: b51aecb63be44b238b256952e0214c36
              name: 'Interface {#IFDESCR}: Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
              key: 'net.if.speed[ifSpeed.{#SNMPINDEX}]'
              delay: 10m
              history: 2w
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in bits per second.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made,
                this object should contain the nominal bandwidth.
                If the bandwidth of the interface is greater than the maximum value reportable by this object then
                this object should report its maximum value (4,294,967,295) and ifHighSpeed must be used to report the interface's speed.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              tags:
                - tag: component
                  value: network
            - uuid: ca660b0cf8b74525a373d1120ecedfcf
              name: 'Interface {#IFDESCR}: Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              delay: 10m
              history: 2w
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              tags:
                - tag: component
                  value: network
              trigger_prototypes:
                - uuid: 7e12fdca05654ca1ae4a3c7fcfe80028
                  expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFDESCR}: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'A link that was previously up is now down'
                  manual_close: 'YES'
                  dependencies:
                    - name: 'No SNMP data collection'
                      expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
                  tags:
                    - tag: scope
                      value: availability
          trigger_prototypes:
            - uuid: d58f209f8bf44ca8bbe149f29bb816ea
              expression: |
                (avg(/Pylon Peplink Balance Template/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Pylon Peplink Balance Template/net.if.speed[ifSpeed.{#SNMPINDEX}]) or
                avg(/Pylon Peplink Balance Template/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Pylon Peplink Balance Template/net.if.speed[ifSpeed.{#SNMPINDEX}])) and
                last(/Pylon Peplink Balance Template/net.if.speed[ifSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Pylon Peplink Balance Template/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Pylon Peplink Balance Template/net.if.speed[ifSpeed.{#SNMPINDEX}]) and
                avg(/Pylon Peplink Balance Template/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Pylon Peplink Balance Template/net.if.speed[ifSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFDESCR}: High bandwidth usage'
              event_name: 'Interface {#IFDESCR}: High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFDESCR}: Link down'
                  expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 9e62227bf16240d89602bbae4ffbd8da
              expression: |
                min(/Pylon Peplink Balance Template/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Pylon Peplink Balance Template/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Pylon Peplink Balance Template/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Pylon Peplink Balance Template/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFDESCR}: High error rate'
              event_name: 'Interface {#IFDESCR}: High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFDESCR}: Link down'
                  expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Pylon Peplink Balance Template/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 2167fe6084014facad7b446c9acce3ee
              name: 'Interface {#IFDESCR}: Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Pylon Peplink Balance Template'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
        - uuid: 850f8bbdf15c477f9a8299d61b89019a
          name: 'PepVPN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PEPVPNID},.1.3.6.1.4.1.23695.200.1.10.1.1.2.1.1,{#PEPVPNIFNAME},.1.3.6.1.4.1.23695.200.1.10.1.1.2.1.2]'
          key: pepvpn.discovery
          delay: 10m
          lifetime: 2d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discover PepVPN Endpoints'
          item_prototypes:
            - uuid: cb295dfd42b84a75a778a5327472e071
              name: 'Profile {#PEPVPNIFNAME} Connection State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.2.1.3["index",".1.3.6.1.4.1.23695.200.1.10.1.1.2.1.1", "{#PEPVPNID}"]'
              key: 'pepvpn.StatusConnectionState[{#PEPVPNID}]'
              history: 2w
              description: 'The state of the PepVPN Tunnel'
              valuemap:
                name: pepvpn.connectionstate
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 7d20357be399460e92588bef1d855052
              name: 'Profile {#PEPVPNIFNAME} WAN1 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.1'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},1]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: dc4471122dba489f9707026489d89bed
              name: 'Profile {#PEPVPNIFNAME} WAN2 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.2'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},2]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 0986c52d1bd847f48e3b13df4e0e18ca
              name: 'Profile {#PEPVPNIFNAME} WAN3 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.3'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},3]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: b210ed30907347188e7da996378505e3
              name: 'Profile {#PEPVPNIFNAME} WAN4 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.4'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},4]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 82d6887105c54f1e86a307cbf112fda6
              name: 'Profile {#PEPVPNIFNAME} WAN5 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.5'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},5]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 711a84b195f94579ac99e4e5b8199199
              name: 'Profile {#PEPVPNIFNAME} WAN6 Dropped Packets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.5.{#PEPVPNID}.1.6'
              key: 'pepvpn.wanIfDropped[{#PEPVPNID},6]'
              history: 2w
              units: bps
              description: 'Total bits dropped via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: f49407f0dcac410cbe1c6c53f6a40632
              name: 'Profile {#PEPVPNIFNAME} WAN1 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.1'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},1]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 4dc1df8b01424c75915e0ebc3f7baf87
              name: 'Profile {#PEPVPNIFNAME} WAN2 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.2'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},2]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 4481b77117304d11a3bc243a16c2f654
              name: 'Profile {#PEPVPNIFNAME} WAN3 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.3'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},3]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: bd9f6b332b18412da0466a054f08a36d
              name: 'Profile {#PEPVPNIFNAME} WAN4 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.4'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},4]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: b0a54835a93a4e21b66e8b4b4f7f38d4
              name: 'Profile {#PEPVPNIFNAME} WAN5 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.5'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},5]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: f838c9c80ee649b2aa449388ae7b5569
              name: 'Profile {#PEPVPNIFNAME} WAN6 Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.6.{#PEPVPNID}.1.6'
              key: 'pepvpn.wanIfLatency[{#PEPVPNID},6]'
              history: 2w
              units: ms
              description: 'Latency to remote peer via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 00c178aac963446b934362d1fac38d31
              name: 'Profile {#PEPVPNIFNAME} WAN1 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.1'
              key: 'pepvpn.wanIfName[{#PEPVPNID},1]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 1 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 6fc3968d497a4c31ab6b57b601fe0019
              name: 'Profile {#PEPVPNIFNAME} WAN2 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.2'
              key: 'pepvpn.wanIfName[{#PEPVPNID},2]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 2 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 44fd4c185ea2403f8d52925d1d332ba4
              name: 'Profile {#PEPVPNIFNAME} WAN3 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.3'
              key: 'pepvpn.wanIfName[{#PEPVPNID},3]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 3 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 2e5361e0fff34a899b9967c53ba23f12
              name: 'Profile {#PEPVPNIFNAME} WAN4 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.4'
              key: 'pepvpn.wanIfName[{#PEPVPNID},4]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 4 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: be0f1a49ae9746a48200c1e4524081db
              name: 'Profile {#PEPVPNIFNAME} WAN5 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.5'
              key: 'pepvpn.wanIfName[{#PEPVPNID},5]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 5 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 521a2984916a4d91a08569a9652c3c67
              name: 'Profile {#PEPVPNIFNAME} WAN6 Interface Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.2.{#PEPVPNID}.1.6'
              key: 'pepvpn.wanIfName[{#PEPVPNID},6]'
              delay: 1h
              history: 1w
              value_type: TEXT
              trends: '0'
              description: 'Name of WAN 6 Interface in tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'Interface offline or not connected'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 70da6e7abb3c48e595d5297c8bee314c
              name: 'Profile {#PEPVPNIFNAME} Total Bits Received'
              type: CALCULATED
              key: 'pepvpn.wanIfOctetInTotal[{#PEPVPNID}]'
              delay: 10s
              history: 90d
              units: bps
              params: 'last(//pepvpn.wanIfOctetIn[{#PEPVPNID},1])+last(//pepvpn.wanIfOctetIn[{#PEPVPNID},2])+last(//pepvpn.wanIfOctetIn[{#PEPVPNID},3])+last(//pepvpn.wanIfOctetIn[{#PEPVPNID},4])+last(//pepvpn.wanIfOctetIn[{#PEPVPNID},5])+last(//pepvpn.wanIfOctetIn[{#PEPVPNID},6])'
              description: Total
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 7813bf14a2204092bd7c251d27b54e18
              name: 'Profile {#PEPVPNIFNAME} WAN1 Bits Received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.1'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},1]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 5c3ca0d9e5f64e8db801e1161fc48d8f
              name: 'Profile {#PEPVPNIFNAME} WAN2 Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.2'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},2]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: efa38d362f19455caeb1b57f4570c52a
              name: 'Profile {#PEPVPNIFNAME} WAN3 Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.3'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},3]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 218423c4cde74dcc8f08295ed3caa2ce
              name: 'Profile {#PEPVPNIFNAME} WAN4 Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.4'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},4]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: cc1cbdc667304432a37a0a78ec3d04d9
              name: 'Profile {#PEPVPNIFNAME} WAN5 Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.5'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},5]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: aac9539f6786449eaf163ce82ee140f5
              name: 'Profile {#PEPVPNIFNAME} WAN6 Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.4.{#PEPVPNID}.1.6'
              key: 'pepvpn.wanIfOctetIn[{#PEPVPNID},6]'
              history: 2w
              units: bps
              description: 'Total bits received via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 716c178638d0483c9563d4c24fa4f46f
              name: 'Profile {#PEPVPNIFNAME} Total Bits Sent'
              type: CALCULATED
              key: 'pepvpn.wanIfOctetOutTotal[{#PEPVPNID}]'
              delay: 10s
              history: 90d
              units: bps
              params: 'last(//pepvpn.wanIfOctetOut[{#PEPVPNID},1])+last(//pepvpn.wanIfOctetOut[{#PEPVPNID},2])+last(//pepvpn.wanIfOctetOut[{#PEPVPNID},3])+last(//pepvpn.wanIfOctetOut[{#PEPVPNID},4])+last(//pepvpn.wanIfOctetOut[{#PEPVPNID},5])+last(//pepvpn.wanIfOctetOut[{#PEPVPNID},6])'
              description: Total
              tags:
                - tag: component
                  value: pepvpn
            - uuid: ce8e194c5efa4a55985967cdee466ca9
              name: 'Profile {#PEPVPNIFNAME} WAN1 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.1'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},1]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 0b0b8983f72947c4ba8246678968200d
              name: 'Profile {#PEPVPNIFNAME} WAN2 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.2'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},2]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 0584396fa4504bf383eb557d3f87b9ac
              name: 'Profile {#PEPVPNIFNAME} WAN3 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.3'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},3]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: b1b49a14688548129f0a171c276ea59a
              name: 'Profile {#PEPVPNIFNAME} WAN4 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.4'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},4]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: efd5c8b0f77746cfb4f2a9c6ec143396
              name: 'Profile {#PEPVPNIFNAME} WAN5 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.5'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},5]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: f932b44e9e8d421c9b09625308f46bce
              name: 'Profile {#PEPVPNIFNAME} WAN6 Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.23695.200.1.10.1.1.3.1.3.{#PEPVPNID}.1.6'
              key: 'pepvpn.wanIfOctetOut[{#PEPVPNID},6]'
              history: 2w
              units: bps
              description: 'Total bits sent via this WAN interface in the PepVPN tunnel'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - '-1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: pepvpn
          trigger_prototypes:
            - uuid: 5461539307054d66894f16e9cb7065fe
              expression: '(not last(/Pylon Peplink Balance Template/system.descr[sysDescr.0])="Peplink FusionHub") and last(/Pylon Peplink Balance Template/pepvpn.StatusConnectionState[{#PEPVPNID}])<>4'
              name: 'Tunnel {#PEPVPNIFNAME} Down'
              opdata: 'Current tunnel state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Device is online and responding to SNMP, but the PepVPN tunnel is not ready to handle traffic'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 864caf51f40c43b29f98b2ad161be5a9
              expression: |
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},1],3m)>={$PL.VPN.DROP.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},2],3m)>={$PL.VPN.DROP.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},3],3m)>={$PL.VPN.DROP.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},4],3m)>={$PL.VPN.DROP.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},5],3m)>={$PL.VPN.DROP.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},6],3m)>={$PL.VPN.DROP.CRIT}
              name: 'Tunnel {#PEPVPNIFNAME} Interface Drops Critical'
              opdata: 'Current Value: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Dropped packets on WAN interface exceeds defined critical limit'
              dependencies:
                - name: 'Tunnel {#PEPVPNIFNAME} Down'
                  expression: '(not last(/Pylon Peplink Balance Template/system.descr[sysDescr.0])="Peplink FusionHub") and last(/Pylon Peplink Balance Template/pepvpn.StatusConnectionState[{#PEPVPNID}])<>4'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 95e1a830e1ce423ab00945cf4d140707
              expression: |
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},1],3m)>={$PL.VPN.DROP.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},2],3m)>={$PL.VPN.DROP.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},3],3m)>={$PL.VPN.DROP.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},4],3m)>={$PL.VPN.DROP.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},5],3m)>={$PL.VPN.DROP.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},6],3m)>={$PL.VPN.DROP.WARN}
              name: 'Tunnel {#PEPVPNIFNAME} Interface Drops Warning'
              opdata: 'Current Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Dropped packets on WAN interface exceeds defined warning limit'
              dependencies:
                - name: 'Tunnel {#PEPVPNIFNAME} Down'
                  expression: '(not last(/Pylon Peplink Balance Template/system.descr[sysDescr.0])="Peplink FusionHub") and last(/Pylon Peplink Balance Template/pepvpn.StatusConnectionState[{#PEPVPNID}])<>4'
                - name: 'Tunnel {#PEPVPNIFNAME} Interface Drops Critical'
                  expression: |
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},1],3m)>={$PL.VPN.DROP.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},2],3m)>={$PL.VPN.DROP.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},3],3m)>={$PL.VPN.DROP.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},4],3m)>={$PL.VPN.DROP.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},5],3m)>={$PL.VPN.DROP.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfDropped[{#PEPVPNID},6],3m)>={$PL.VPN.DROP.CRIT}
              tags:
                - tag: component
                  value: pepvpn
            - uuid: 9c150ac1611f4b4d8aa821d4dfdd14b4
              expression: |
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},1],3m)>={$PL.VPN.LATENCY.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},2],3m)>={$PL.VPN.LATENCY.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},3],3m)>={$PL.VPN.LATENCY.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},4],3m)>={$PL.VPN.LATENCY.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},5],3m)>={$PL.VPN.LATENCY.CRIT} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},6],3m)>={$PL.VPN.LATENCY.CRIT}
              name: 'Tunnel {#PEPVPNIFNAME} Interface Latency Critical'
              opdata: 'Current Value: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Latency on WAN interface exceeds defined critical limit'
              dependencies:
                - name: 'Tunnel {#PEPVPNIFNAME} Down'
                  expression: '(not last(/Pylon Peplink Balance Template/system.descr[sysDescr.0])="Peplink FusionHub") and last(/Pylon Peplink Balance Template/pepvpn.StatusConnectionState[{#PEPVPNID}])<>4'
              tags:
                - tag: component
                  value: pepvpn
            - uuid: dd35e3eb570d474781516cee26374fb4
              expression: |
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},1],3m)>={$PL.VPN.LATENCY.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},2],3m)>={$PL.VPN.LATENCY.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},3],3m)>={$PL.VPN.LATENCY.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},4],3m)>={$PL.VPN.LATENCY.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},5],3m)>={$PL.VPN.LATENCY.WARN} or
                avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},6],3m)>={$PL.VPN.LATENCY.WARN}
              name: 'Tunnel {#PEPVPNIFNAME} Interface Latency Warning'
              opdata: 'Current Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Latency on WAN interface exceeds defined warning limit'
              dependencies:
                - name: 'Tunnel {#PEPVPNIFNAME} Down'
                  expression: '(not last(/Pylon Peplink Balance Template/system.descr[sysDescr.0])="Peplink FusionHub") and last(/Pylon Peplink Balance Template/pepvpn.StatusConnectionState[{#PEPVPNID}])<>4'
                - name: 'Tunnel {#PEPVPNIFNAME} Interface Latency Critical'
                  expression: |
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},1],3m)>={$PL.VPN.LATENCY.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},2],3m)>={$PL.VPN.LATENCY.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},3],3m)>={$PL.VPN.LATENCY.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},4],3m)>={$PL.VPN.LATENCY.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},5],3m)>={$PL.VPN.LATENCY.CRIT} or
                    avg(/Pylon Peplink Balance Template/pepvpn.wanIfLatency[{#PEPVPNID},6],3m)>={$PL.VPN.LATENCY.CRIT}
              tags:
                - tag: component
                  value: pepvpn
      tags:
        - tag: IsUPS
          value: 'False'
      macros:
        - macro: '{$CPU.AVG.TIME}'
          value: 1m
        - macro: '{$CPU.CRIT}'
          value: '80'
        - macro: '{$CPU.WARN}'
          value: '60'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
        - macro: '{$IF.UTIL.MAX}'
          value: '95'
        - macro: '{$MEM.CRIT}'
          value: '80'
        - macro: '{$MEM.WARN}'
          value: '60'
        - macro: '{$PL.IFTYPE.FILTER}'
          value: ^1$
          description: 'Filter "other" ifType which corresponds to FH tunnels'
        - macro: '{$PL.VPN.DROP.CRIT}'
          value: '500000'
          description: 'Critical level for dropped packets on pepvpn interface in bits'
        - macro: '{$PL.VPN.DROP.WARN}'
          value: '100000'
          description: 'Warning level for dropped packets on pepvpn interface in bits'
        - macro: '{$PL.VPN.LATENCY.CRIT}'
          value: '300'
          description: 'Critical level for tunnel latency on pepvpn interface'
        - macro: '{$PL.VPN.LATENCY.WARN}'
          value: '150'
          description: 'Warning level for tunnel latency on pepvpn interface'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
      valuemaps:
        - uuid: 0b44bbc249134826b89c9ec0918dbb98
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 5bbdaf945b2d499384fb59105ef3621d
          name: pepvpn.connectionstate
          mappings:
            - value: '0'
              newvalue: start
            - value: '1'
              newvalue: authen
            - value: '2'
              newvalue: tunnel
            - value: '3'
              newvalue: route
            - value: '4'
              newvalue: connected
        - uuid: b9dc42deca174d61aefebe863da280d1
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 0341006d7264488287b862aa0dba826a
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: f082db8fb8f14356bd4e7617086dbd38
      expression: '(last(/Pylon Peplink Balance Template/system.hw.uptime[hrSystemUptime.0])>0 and last(/Pylon Peplink Balance Template/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/Pylon Peplink Balance Template/system.hw.uptime[hrSystemUptime.0])=0 and last(/Pylon Peplink Balance Template/system.net.uptime[sysUpTime.0])<10m)'
      name: 'Balance has been restarted'
      event_name: '{HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'No SNMP data collection'
          expression: 'max(/Pylon Peplink Balance Template/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
    - uuid: 6df46786ee1f4dd9a2cd4936fad1545a
      expression: 'min(/Pylon Peplink Balance Template/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Pylon Peplink Balance Template/icmppingloss,5m)<100'
      name: 'High ICMP ping loss'
      opdata: 'Loss: {ITEM.LASTVALUE1}'
      priority: WARNING
      dependencies:
        - name: 'Unavailable by ICMP ping'
          expression: 'max(/Pylon Peplink Balance Template/icmpping,#3)=0'
      tags:
        - tag: scope
          value: availability
        - tag: scope
          value: performance
    - uuid: cba38cb846074d87a16fb72c420ce5ed
      expression: 'avg(/Pylon Peplink Balance Template/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
      name: 'High ICMP ping response time'
      opdata: 'Value: {ITEM.LASTVALUE1}'
      priority: WARNING
      dependencies:
        - name: 'High ICMP ping loss'
          expression: 'min(/Pylon Peplink Balance Template/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Pylon Peplink Balance Template/icmppingloss,5m)<100'
        - name: 'Unavailable by ICMP ping'
          expression: 'max(/Pylon Peplink Balance Template/icmpping,#3)=0'
      tags:
        - tag: scope
          value: availability
        - tag: scope
          value: performance
    - uuid: 35c09d88068948ca9ff9d5ffe761d803
      expression: 'max(/Pylon Peplink Balance Template/icmpping,#3)=0'
      name: 'Unavailable by ICMP ping'
      priority: HIGH
      description: 'Last three attempts returned timeout.  Please check device connectivity.'
      tags:
        - tag: scope
          value: availability
